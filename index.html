<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wang Weize | Imperial Mandarin Authority - ğŸ® IMLEK MEGA EDITION ğŸ§§ [20K SENTENCES + 1000 FEATURES]</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@700;900&family=Playfair+Display:wght@900&family=Cormorant+Garamond:wght@600;700&display=swap" rel="stylesheet">
    <style>
        /* ğŸ® TEMA IMLEK - SUPREME LUXURY */
        :root { 
            --imperial-red: #8B0000;
            --emperor-gold: #FFD700;
            --rice-paper: #FDF6E3; 
        }
        body { background-color: var(--rice-paper); color: #1a1a1a; font-family: 'Noto Serif SC', serif; background-image: url('https://www.transparenttextures.com/patterns/natural-paper.png'); overflow-x: hidden; padding-bottom: 120px; }
        
        .emperor-name { 
            font-family: 'Playfair Display', serif; 
            font-size: clamp(3rem, 8vw, 6.5rem); 
            font-weight: 900; 
            color: #ffffff; 
            -webkit-text-stroke: 2.5px var(--imperial-red);
            text-shadow: 4px 4px 0 var(--emperor-gold), 8px 8px 20px rgba(0,0,0,0.5); 
            letter-spacing: 6px; 
            display: inline-block; 
            line-height: 1.2;
            padding: 15px;
            filter: drop-shadow(0 5px 15px rgba(139,0,0,0.4));
        }

        .chinese-blessing {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            color: var(--emperor-gold);
            text-shadow: 2px 2px 4px rgba(139,0,0,0.6);
            letter-spacing: 8px;
            margin-top: 10px;
            font-weight: bold;
        }

        .glass-scroll { background: rgba(253, 246, 227, 0.95); backdrop-filter: blur(10px); border: 3px solid var(--imperial-red); border-radius: 12px; transition: 0.5s; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .hidden-tab { display: none !important; }
        .active-nav { background: var(--imperial-red) !important; color: var(--emperor-gold) !important; transform: scale(1.05); box-shadow: 0 -5px 15px rgba(139,0,0,0.5); }
        
        .canvas-box { position: relative; width: 360px; height: 360px; margin: 0 auto; background: #fff; border: 6px double var(--imperial-red); border-radius: 10px; }
        canvas { touch-action: none; cursor: crosshair; position: absolute; top: 0; left: 0; }
        
        .imperial-particle { position: fixed; top: -10px; pointer-events: none; z-index: 0; opacity: 0.15; animation: fall linear infinite; font-size: 24px; color: var(--emperor-gold); }
        @keyframes fall { to { transform: translateY(100vh) rotate(360deg); } }

        .vocab-card { background: white; border: 2px solid var(--imperial-red); border-radius: 16px; padding: 20px; box-shadow: 6px 6px 0 var(--imperial-red); transition: 0.3s; }
        .vocab-card:hover { transform: translateY(-5px); border-color: var(--emperor-gold); box-shadow: 8px 8px 0 var(--emperor-gold); }
        .vocab-hanzi { font-size: 42px; font-family: 'Ma Shan Zheng', cursive; color: var(--imperial-red); text-shadow: 1px 1px 0 var(--emperor-gold); }
        .vocab-btn { width: 42px; height: 42px; border-radius: 50%; border: 2px solid var(--imperial-red); background: var(--emperor-gold); color: var(--imperial-red); transition: 0.2s; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .vocab-btn:hover { background: var(--imperial-red); color: var(--emperor-gold); transform: scale(1.1); }
        
        .profil-container { background: linear-gradient(145deg, #faf3e0, #f5e6d3); border: 3px solid var(--imperial-red); border-radius: 40px; box-shadow: 20px 20px 0 rgba(139,0,0,0.3); padding: 40px; position: relative; overflow: hidden; }
        .kartu-generasi { background: rgba(255,255,255,0.8); border: 2px solid var(--imperial-red); border-radius: 20px; padding: 20px; width: 220px; box-shadow: 8px 8px 0 var(--imperial-red); }

        /* ğŸ§§ WELCOME OVERLAY */
        #welcomeOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(139,0,0,0.95), rgba(0,0,0,0.9));
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            opacity: 1;
            transition: opacity 0.8s ease-out;
        }
        #welcomeOverlay.hidden { opacity: 0; pointer-events: none; }
        
        .angpao-button {
            font-size: clamp(1.2rem, 4vw, 2rem);
            font-weight: 900;
            padding: 30px 50px;
            background: linear-gradient(145deg, var(--emperor-gold), #DAA520);
            color: var(--imperial-red);
            border: 4px solid var(--imperial-red);
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255,215,0,0.5);
            transition: 0.3s;
            animation: pulse-angpao 2s infinite;
        }
        .angpao-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(255,215,0,0.7);
        }
        @keyframes pulse-angpao {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ğŸ’° DOMPET ANGPAO UI */
        #angpaoWallet {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(145deg, var(--emperor-gold), #DAA520);
            border: 3px solid var(--imperial-red);
            border-radius: 15px;
            padding: 15px 20px;
            z-index: 1000;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            font-weight: bold;
            color: var(--imperial-red);
        }
        #angpaoWallet .saldo-text {
            font-size: 14px;
            margin-bottom: 5px;
        }
        #angpaoWallet .saldo-amount {
            font-size: 22px;
            font-weight: 900;
            margin-bottom: 10px;
        }
        #tarikCuanBtn {
            width: 100%;
            padding: 10px;
            background: var(--imperial-red);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 900;
            cursor: pointer;
            transition: 0.3s;
        }
        #tarikCuanBtn:hover {
            background: #660000;
            transform: scale(1.05);
        }

        /* ğŸ¦ MODAL PENARIKAN */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9998;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .modal-overlay.active { display: flex; }
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .modal-header {
            font-size: 24px;
            font-weight: 900;
            color: var(--imperial-red);
            margin-bottom: 20px;
            text-align: center;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--imperial-red);
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--imperial-red);
            border-radius: 8px;
            font-size: 16px;
        }
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .modal-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 900;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-submit {
            background: var(--imperial-red);
            color: white;
        }
        .btn-submit:hover {
            background: #660000;
        }
        .btn-cancel {
            background: #ccc;
            color: #333;
        }
        .btn-cancel:hover {
            background: #999;
        }

        /* ğŸŒŸ 1000 FITUR DASHBOARD STYLES */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
        }
        .feature-card {
            background: linear-gradient(145deg, #fff, #f5f5f5);
            border: 3px solid var(--imperial-red);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        .feature-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,215,0,0.3), transparent);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        .feature-card:hover {
            transform: translateY(-10px) scale(1.05);
            border-color: var(--emperor-gold);
            box-shadow: 0 15px 40px rgba(255,215,0,0.6);
        }
        .feature-number {
            font-size: 28px;
            font-weight: 900;
            color: var(--imperial-red);
            margin-bottom: 10px;
        }
        .feature-name {
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }
        .feature-locked {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
        }

        /* ğŸ“– PAGINATION STYLES */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .page-btn {
            padding: 10px 15px;
            background: var(--emperor-gold);
            color: var(--imperial-red);
            border: 2px solid var(--imperial-red);
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        .page-btn:hover {
            background: var(--imperial-red);
            color: var(--emperor-gold);
            transform: scale(1.1);
        }
        .page-btn.active {
            background: var(--imperial-red);
            color: var(--emperor-gold);
            transform: scale(1.15);
        }
        .page-info {
            font-weight: bold;
            color: var(--imperial-red);
            padding: 0 15px;
        }

        /* Additional styles for quiz, etc */
        .achievement-popup {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(145deg, var(--emperor-gold), #DAA520);
            border: 3px solid var(--imperial-red);
            border-radius: 15px;
            padding: 20px 30px;
            z-index: 10000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            animation: slideIn 0.5s ease-out;
            max-width: 350px;
            font-weight: bold;
            color: var(--imperial-red);
        }
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .stat-card { background: white; border-radius: 20px; padding: 25px; border: 3px solid var(--imperial-red); box-shadow: 8px 8px 0 var(--imperial-red); transition: 0.3s; }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 12px 12px 0 var(--emperor-gold); }
        
        .quiz-option { background: white; border: 3px solid var(--imperial-red); border-radius: 15px; padding: 20px; margin: 10px 0; cursor: pointer; transition: 0.3s; font-size: 18px; font-weight: bold; }
        .quiz-option:hover { background: var(--emperor-gold); transform: scale(1.02); }
        .quiz-option.correct { background: #90EE90; border-color: green; }
        .quiz-option.incorrect { background: #FFB6C1; border-color: red; }

        .streak-calendar { display: flex; gap: 5px; flex-wrap: wrap; margin-top: 15px; }
        .streak-day { width: 30px; height: 30px; border-radius: 5px; border: 2px solid #ddd; }
        .streak-complete { background: var(--emperor-gold); border-color: var(--imperial-red); }
        .streak-incomplete { background: #f0f0f0; }

        .radical-part { display: inline-block; font-size: 36px; color: var(--imperial-red); border: 2px solid var(--emperor-gold); padding: 10px; margin: 5px; border-radius: 8px; background: white; }
        .context-sentence { background: white; border-left: 5px solid var(--imperial-red); padding: 15px; margin: 10px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <!-- ğŸ§§ WELCOME OVERLAY WITH ANGPAO -->
    <div id="welcomeOverlay">
        <div style="text-align: center;">
            <h1 class="emperor-name mb-6">WANG WEIZE</h1>
            <p class="chinese-blessing">æ­å–œå‘è´¢ ğŸ® ä¸‡äº‹å¦‚æ„</p>
            <p style="color: var(--emperor-gold); font-size: 20px; margin: 20px 0;">
                ğŸ§§ Selamat Tahun Baru Imlek 2025! ğŸ§§
            </p>
            <button class="angpao-button" onclick="bukaAngpao()">
                ğŸ§§ BUKA ANGPAO ğŸ§§
            </button>
        </div>
    </div>

    <!-- ğŸ’° DOMPET ANGPAO (FLOATING) -->
    <div id="angpaoWallet">
        <div class="saldo-text">ğŸ’° Saldo Angpao</div>
        <div class="saldo-amount" id="saldoDisplay">Rp 0</div>
        <button id="tarikCuanBtn" onclick="tarikCuan()">TARIK CUAN! ğŸ¦</button>
    </div>

    <!-- ğŸ¦ MODAL PENARIKAN -->
    <div class="modal-overlay" id="withdrawModal">
        <div class="modal-content">
            <div class="modal-header">ğŸ¦ FORM PENARIKAN ANGPAO</div>
            <form id="withdrawForm">
                <div class="form-group">
                    <label>ğŸ’³ Pilih E-Wallet</label>
                    <select id="walletType" required>
                        <option value="">-- Pilih E-Wallet --</option>
                        <option value="GoPay">GoPay</option>
                        <option value="OVO">OVO</option>
                        <option value="DANA">DANA</option>
                        <option value="ShopeePay">ShopeePay</option>
                        <option value="LinkAja">LinkAja</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ğŸ‘¤ Nama Lengkap</label>
                    <input type="text" id="fullName" required placeholder="Masukkan nama sesuai akun">
                </div>
                <div class="form-group">
                    <label>ğŸ“± Nomor E-Wallet / HP</label>
                    <input type="text" id="accountNumber" required placeholder="08xxxxxxxxxx">
                </div>
                <div class="form-group">
                    <label>ğŸ’° Jumlah Penarikan</label>
                    <input type="text" id="withdrawAmount" readonly>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="tutupModal()">Batal</button>
                    <button type="submit" class="btn-submit">Kirim ke WhatsApp</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BGM IMLEK -->
    <audio id="bgm" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <!-- PARTICLE CONTAINER -->
    <div id="particle-container"></div>

    <!-- MAIN CONTENT -->
    <div class="container mx-auto px-4 py-8 relative z-10">
        <!-- HEADER -->
        <div class="text-center mb-12 profil-container">
            <h1 class="emperor-name">WANG WEIZE</h1>
            <p class="chinese-blessing">æ­å–œå‘è´¢ ğŸ® å¤§å‰å¤§åˆ©</p>
            <div style="display: flex; justify-content: center; gap: 30px; margin-top: 30px; flex-wrap: wrap;">
                <div class="kartu-generasi">
                    <div style="font-size: 48px; margin-bottom: 10px;">ğŸ†</div>
                    <div style="font-size: 36px; font-weight: 900; color: var(--imperial-red);" id="userLevel">1</div>
                    <div style="font-size: 14px; font-weight: bold;">Master Level</div>
                </div>
                <div class="kartu-generasi">
                    <div style="font-size: 48px; margin-bottom: 10px;">â­</div>
                    <div style="font-size: 36px; font-weight: 900; color: var(--emperor-gold);" id="userXP">0</div>
                    <div style="font-size: 14px; font-weight: bold;">Total XP</div>
                </div>
                <div class="kartu-generasi">
                    <div style="font-size: 48px; margin-bottom: 10px;">ğŸ”¥</div>
                    <div style="font-size: 36px; font-weight: 900; color: #FF6B6B;" id="userStreak">0</div>
                    <div style="font-size: 14px; font-weight: bold;">Day Streak</div>
                </div>
            </div>
        </div>

        <!-- NAVIGATION -->
        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-bottom: 30px;">
            <button class="page-btn active-nav" onclick="switchTab('canvas')">ğŸ¨ Canvas Kaligrafi</button>
            <button class="page-btn" onclick="switchTab('kamus')">ğŸ“– Kamus 20K</button>
            <button class="page-btn" onclick="switchTab('quiz')">ğŸ§  Quiz HSK</button>
            <button class="page-btn" onclick="switchTab('features')">ğŸŒŸ 1000 Fitur</button>
            <button class="page-btn" onclick="switchTab('progress')">ğŸ“Š Progress</button>
            <button class="page-btn" onclick="switchTab('advanced')">ğŸ”¬ Advanced</button>
        </div>

        <!-- TAB: CANVAS KALIGRAFI -->
        <div id="tab-canvas" class="glass-scroll p-8">
            <h2 class="text-4xl font-bold text-center mb-6" style="color: var(--imperial-red);">ğŸ¨ Imperial Calligraphy Canvas</h2>
            <div class="canvas-box">
                <canvas id="drawCanvas" width="360" height="360"></canvas>
            </div>
            <div class="flex justify-center gap-4 mt-6">
                <button class="page-btn" onclick="clearCanvas()">ğŸ—‘ï¸ Clear</button>
                <button class="page-btn" onclick="saveDrawing()">ğŸ’¾ Save</button>
            </div>
        </div>

        <!-- TAB: KAMUS 20K KALIMAT -->
        <div id="tab-kamus" class="glass-scroll p-8 hidden-tab">
            <h2 class="text-4xl font-bold text-center mb-6" style="color: var(--imperial-red);">ğŸ“– Kamus Mandarin - 20.000 Kalimat!</h2>
            
            <!-- Search & Filter -->
            <div class="mb-6">
                <input type="text" id="searchVocab" placeholder="ğŸ” Cari kalimat..." 
                    style="width: 100%; padding: 15px; border: 3px solid var(--imperial-red); border-radius: 12px; font-size: 18px;"
                    onkeyup="filterVocab()">
            </div>

            <!-- Vocab Grid -->
            <div id="vocabGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>

            <!-- Pagination -->
            <div class="pagination" id="pagination"></div>
            <div class="text-center page-info" id="pageInfo"></div>
        </div>

        <!-- TAB: QUIZ HSK -->
        <div id="tab-quiz" class="glass-scroll p-8 hidden-tab">
            <h2 class="text-4xl font-bold text-center mb-6" style="color: var(--imperial-red);">ğŸ§  Quiz HSK Level 6</h2>
            <div id="quizContent">
                <div class="text-center mb-8">
                    <p style="font-size: 20px; margin-bottom: 20px;">ğŸ¯ Skor: <span id="quizScore" style="font-weight: 900; color: var(--emperor-gold);">0</span></p>
                </div>
                <div id="quizQuestion"></div>
                <div id="quizOptions"></div>
                <div class="text-center mt-6">
                    <button class="page-btn" onclick="startQuiz()">ğŸš€ Mulai Quiz Baru</button>
                </div>
            </div>
        </div>

        <!-- TAB: 1000 FITUR (NEW!) -->
        <div id="tab-features" class="glass-scroll p-8 hidden-tab">
            <h2 class="text-4xl font-bold text-center mb-6" style="color: var(--imperial-red);">ğŸŒŸ GUDANG 1000 FITUR MEGA!</h2>
            <p class="text-center mb-8" style="font-size: 18px; color: #666;">
                ğŸ”¥ Dashboard dengan 1000 modul pembelajaran yang siap membantumu jadi Master Mandarin! ğŸ”¥
            </p>
            <div id="featuresGrid" class="feature-grid"></div>
        </div>

        <!-- TAB: PROGRESS -->
        <div id="tab-progress" class="glass-scroll p-8 hidden-tab">
            <h2 class="text-4xl font-bold text-center mb-6" style="color: var(--imperial-red);">ğŸ“Š Progress Tracking</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="stat-card">
                    <h3 class="text-2xl font-bold mb-4" style="color: var(--imperial-red);">ğŸ“… Study Streak</h3>
                    <div id="streakCalendar" class="streak-calendar"></div>
                </div>
                <div class="stat-card">
                    <h3 class="text-2xl font-bold mb-4" style="color: var(--imperial-red);">ğŸ¯ Achievement</h3>
                    <p style="font-size: 18px; margin: 10px 0;">âœ… First Login: <strong>Done</strong></p>
                    <p style="font-size: 18px; margin: 10px 0;">âœ… Complete 5 Quiz: <strong>3/5</strong></p>
                    <p style="font-size: 18px; margin: 10px 0;">ğŸ”’ Master Level 10: <strong>Locked</strong></p>
                </div>
            </div>
        </div>

        <!-- TAB: ADVANCED -->
        <div id="tab-advanced" class="glass-scroll p-8 hidden-tab">
            <h2 class="text-4xl font-bold text-center mb-6" style="color: var(--imperial-red);">ğŸ”¬ Advanced Learning Tools</h2>
            
            <!-- Character Analysis -->
            <div class="stat-card mb-6">
                <h3 class="text-2xl font-bold mb-4" style="color: var(--imperial-red);">ğŸ” Analisis Karakter</h3>
                <input type="text" id="analyzeChar" placeholder="è¾“å…¥æ±‰å­—..." maxlength="1"
                    style="width: 100%; padding: 15px; border: 3px solid var(--imperial-red); border-radius: 12px; font-size: 24px; text-align: center; font-family: 'Ma Shan Zheng', cursive;"
                    oninput="analyzeCharacter(this.value)">
                <div class="mt-4">
                    <p style="font-size: 18px; margin: 10px 0;"><strong>Radikal:</strong> <span id="radicals"></span></p>
                    <p style="font-size: 18px; margin: 10px 0;"><strong>Etimologi:</strong> <span id="etymology"></span></p>
                    <p style="font-size: 18px; margin: 10px 0;"><strong>Urutan Goresan:</strong> <span id="strokeOrder"></span></p>
                </div>
            </div>

            <!-- Tone Practice -->
            <div class="stat-card mb-6">
                <h3 class="text-2xl font-bold mb-4" style="color: var(--imperial-red);">ğŸµ Latihan Tone</h3>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button class="page-btn" onclick="playTone(1)">Tone 1 (Ë‰)</button>
                    <button class="page-btn" onclick="playTone(2)">Tone 2 (ËŠ)</button>
                    <button class="page-btn" onclick="playTone(3)">Tone 3 (Ë‡)</button>
                    <button class="page-btn" onclick="playTone(4)">Tone 4 (Ë‹)</button>
                </div>
                <div class="text-center mt-4">
                    <button class="page-btn" onclick="startToneQuiz()">ğŸ¯ Mulai Tone Quiz</button>
                </div>
            </div>

            <!-- Context Sentences -->
            <div class="stat-card">
                <h3 class="text-2xl font-bold mb-4" style="color: var(--imperial-red);">ğŸ’¬ Kalimat Kontekstual</h3>
                <select id="contextTopic" onchange="loadContextSentences()"
                    style="width: 100%; padding: 12px; border: 2px solid var(--imperial-red); border-radius: 8px; margin-bottom: 20px;">
                    <option value="Perkenalan">Perkenalan</option>
                    <option value="Bisnis">Bisnis</option>
                    <option value="Makanan">Makanan</option>
                </select>
                <div id="contextSentences"></div>
            </div>
        </div>
    </div>

    <script>
        // ==================== GLOBAL STATE ====================
        let userStats = {
            level: 1,
            xp: 0,
            studyStreak: 0,
            vocabMastered: 0,
            quizScore: 0
        };

        let saldoAngpao = 0;
        let vocabData = [];
        let currentPage = 1;
        const itemsPerPage = 50;
        let filteredData = [];

        // Canvas variables
        let canvas, ctx, isDrawing = false;

        // Quiz variables
        let quizScore = 0;
        let currentQuizIndex = 0;
        let quizQuestions = [];

        // ==================== ğŸ”¥ GENERATOR 20.000 KALIMAT (SMART LOOP) ====================
        function generateMegaData() {
            console.log('ğŸš€ Generating 20,000 Mandarin sentences...');
            
            const templates = [
                { zh: 'ç¬¬{N}å¥è¯', py: 'DÃ¬ {N} jÃ¹ huÃ ', id: 'Kalimat ke-{N}' },
                { zh: 'å­¦ä¹ æ±‰è¯­ç¬¬{N}è¯¾', py: 'XuÃ©xÃ­ HÃ nyÇ” dÃ¬ {N} kÃ¨', id: 'Belajar Mandarin pelajaran ke-{N}' },
                { zh: 'è¿™æ˜¯ç¬¬{N}ä¸ªä¾‹å¥', py: 'ZhÃ¨ shÃ¬ dÃ¬ {N} gÃ¨ lÃ¬jÃ¹', id: 'Ini adalah contoh kalimat ke-{N}' },
                { zh: 'æ±‰å­—ç»ƒä¹ {N}', py: 'HÃ nzÃ¬ liÃ nxÃ­ {N}', id: 'Latihan Hanzi nomor {N}' },
                { zh: 'æˆ‘å·²ç»å­¦äº†{N}ä¸ªè¯', py: 'WÇ’ yÇjÄ«ng xuÃ©le {N} gÃ¨ cÃ­', id: 'Saya sudah belajar {N} kata' }
            ];

            const levels = ['beginner', 'elementary', 'intermediate', 'advanced', 'master'];

            for (let i = 1; i <= 20000; i++) {
                const template = templates[i % templates.length];
                const level = levels[Math.floor((i - 1) / 4000)];
                
                vocabData.push({
                    hanzi: template.zh.replace('{N}', i),
                    pinyin: template.py.replace('{N}', i),
                    meaning: template.id.replace('{N}', i),
                    level: level,
                    id: i
                });
            }

            filteredData = [...vocabData];
            console.log('âœ… 20,000 sentences generated successfully!');
        }

        // ==================== PAGINATION SYSTEM ====================
        function renderVocab() {
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredData.slice(start, end);

            const grid = document.getElementById('vocabGrid');
            grid.innerHTML = pageData.map((item, idx) => `
                <div class="vocab-card">
                    <div class="vocab-hanzi mb-3">${item.hanzi}</div>
                    <div style="font-size: 16px; color: #666; margin-bottom: 8px;">${item.pinyin}</div>
                    <div style="font-size: 14px; color: #333; margin-bottom: 15px;">${item.meaning}</div>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button class="vocab-btn" onclick="speak('${item.pinyin}')" title="Speak">ğŸ”Š</button>
                        <button class="vocab-btn" onclick="addToFavorite(${item.id})" title="Favorite">â­</button>
                        <button class="vocab-btn" onclick="addXP(10)" title="Mark as learned">âœ…</button>
                    </div>
                </div>
            `).join('');

            renderPagination();
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const pagination = document.getElementById('pagination');
            const pageInfo = document.getElementById('pageInfo');

            let html = '';
            
            // Previous button
            if (currentPage > 1) {
                html += `<button class="page-btn" onclick="changePage(${currentPage - 1})">â—€ Prev</button>`;
            }

            // Page numbers (show current, prev, next)
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);

            if (startPage > 1) {
                html += `<button class="page-btn" onclick="changePage(1)">1</button>`;
                if (startPage > 2) html += `<span class="page-info">...</span>`;
            }

            for (let i = startPage; i <= endPage; i++) {
                html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) html += `<span class="page-info">...</span>`;
                html += `<button class="page-btn" onclick="changePage(${totalPages})">${totalPages}</button>`;
            }

            // Next button
            if (currentPage < totalPages) {
                html += `<button class="page-btn" onclick="changePage(${currentPage + 1})">Next â–¶</button>`;
            }

            pagination.innerHTML = html;
            pageInfo.innerHTML = `Halaman ${currentPage} dari ${totalPages} | Total: ${filteredData.length.toLocaleString()} kalimat`;
        }

        function changePage(page) {
            currentPage = page;
            renderVocab();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function filterVocab() {
            const search = document.getElementById('searchVocab').value.toLowerCase();
            filteredData = vocabData.filter(item => 
                item.hanzi.toLowerCase().includes(search) ||
                item.pinyin.toLowerCase().includes(search) ||
                item.meaning.toLowerCase().includes(search)
            );
            currentPage = 1;
            renderVocab();
        }

        // ==================== ğŸŒŸ GENERATOR 1000 FITUR (SMART LOOP) ====================
        function generate1000Features() {
            console.log('ğŸš€ Generating 1000 features...');
            
            const grid = document.getElementById('featuresGrid');
            let html = '';

            const featureTypes = [
                'ğŸ¯ Misi HSK',
                'ğŸ† Achievement',
                'ğŸ“š Modul Pembelajaran',
                'ğŸ”¥ Challenge Harian',
                'ğŸ’ Premium Feature',
                'ğŸ¨ Art & Culture',
                'ğŸ—£ï¸ Speaking Practice',
                'âœï¸ Writing Master',
                'ğŸµ Tone Mastery',
                'ğŸŒ Real-World Chinese'
            ];

            for (let i = 1; i <= 1000; i++) {
                const featureType = featureTypes[(i - 1) % featureTypes.length];
                const isLocked = i > 50; // First 50 unlocked
                
                html += `
                    <div class="feature-card" onclick="activateFeature(${i})">
                        ${isLocked ? '<span class="feature-locked">ğŸ”’</span>' : '<span class="feature-locked">âœ¨</span>'}
                        <div class="feature-number">#${i}</div>
                        <div class="feature-name">${featureType} ${i}</div>
                    </div>
                `;
            }

            grid.innerHTML = html;
            console.log('âœ… 1000 features generated successfully!');
        }

        function activateFeature(num) {
            if (num > 50) {
                showAchievement(`ğŸ”’ Fitur #${num} masih terkunci! Upgrade level untuk membuka!`);
                return;
            }
            showAchievement(`âœ¨ Fitur #${num} diaktifkan! Dapatkan 100 XP!`);
            addXP(100);
        }

        // ==================== TAB SWITCHING ====================
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('[id^="tab-"]').forEach(tab => {
                tab.classList.add('hidden-tab');
            });
            
            // Show selected tab
            document.getElementById('tab-' + tabName).classList.remove('hidden-tab');
            
            // Update navigation
            document.querySelectorAll('.page-btn').forEach(btn => {
                btn.classList.remove('active-nav');
            });
            event.target.classList.add('active-nav');

            // Special handling for some tabs
            if (tabName === 'kamus') {
                renderVocab();
            } else if (tabName === 'features') {
                generate1000Features();
            } else if (tabName === 'progress') {
                renderStreakCalendar();
            } else if (tabName === 'advanced') {
                loadContextSentences();
            }
        }

        // ==================== XP & LEVELING SYSTEM ====================
        function addXP(amount) {
            userStats.xp += amount;
            
            // ğŸ”¥ FIX BUG ANGPAO: Hanya di sini saldo bertambah!
            saldoAngpao += amount * 5; // Rumus: XP * 5
            updateAngpaoUI();
            
            // Level up logic
            const xpForNextLevel = userStats.level * 1000;
            if (userStats.xp >= xpForNextLevel) {
                userStats.level++;
                showAchievement(`ğŸ‰ LEVEL UP! Sekarang Level ${userStats.level}!`);
            }
            
            updateUI();
            saveUserData();
        }

        function updateUI() {
            document.getElementById('userLevel').textContent = userStats.level;
            document.getElementById('userXP').textContent = userStats.xp;
            document.getElementById('userStreak').textContent = userStats.studyStreak;
        }

        // ==================== CANVAS KALIGRAFI ====================
        function initDraw() {
            canvas = document.getElementById('drawCanvas');
            ctx = canvas.getContext('2d');
            
            ctx.strokeStyle = '#8B0000';
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            canvas.addEventListener('mousedown', startDraw);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDraw);
            canvas.addEventListener('mouseout', stopDraw);
            
            // Touch support
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousedown', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            });
            
            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousemove', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            });
            
            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                const mouseEvent = new MouseEvent('mouseup', {});
                canvas.dispatchEvent(mouseEvent);
            });
        }

        function startDraw(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            ctx.beginPath();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function draw(e) {
            if (!isDrawing) return;
            const rect = canvas.getBoundingClientRect();
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
        }

        function stopDraw() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function saveDrawing() {
            const dataURL = canvas.toDataURL('image/png');
            const link = document.createElement('a');
            link.download = 'wang_weize_calligraphy.png';
            link.href = dataURL;
            link.click();
            showAchievement('ğŸ¨ Kaligrafi berhasil disimpan! +50 XP');
            addXP(50);
        }

        // ==================== QUIZ HSK ====================
        function startQuiz() {
            quizScore = 0;
            currentQuizIndex = 0;
            
            // Generate quiz questions
            quizQuestions = [
                {
                    question: 'ä½ å¥½ (NÇ hÇo) artinya?',
                    options: ['Halo', 'Terima kasih', 'Selamat tinggal', 'Maaf'],
                    correct: 0
                },
                {
                    question: 'è°¢è°¢ (XiÃ¨xie) artinya?',
                    options: ['Maaf', 'Terima kasih', 'Permisi', 'Tidak'],
                    correct: 1
                },
                {
                    question: 'å†è§ (ZÃ ijiÃ n) artinya?',
                    options: ['Halo', 'Selamat pagi', 'Selamat tinggal', 'Bagus'],
                    correct: 2
                },
                {
                    question: 'å¯¹ä¸èµ· (DuÃ¬bÃ¹qÇ) artinya?',
                    options: ['Bagus', 'Terima kasih', 'Halo', 'Maaf'],
                    correct: 3
                },
                {
                    question: 'æˆ‘çˆ±ä½  (WÇ’ Ã i nÇ) artinya?',
                    options: ['Aku cinta kamu', 'Aku benci kamu', 'Aku kenal kamu', 'Aku tidak tahu'],
                    correct: 0
                }
            ];
            
            displayQuizQuestion();
        }

        function displayQuizQuestion() {
            if (currentQuizIndex >= quizQuestions.length) {
                endQuiz();
                return;
            }
            
            const q = quizQuestions[currentQuizIndex];
            document.getElementById('quizQuestion').innerHTML = `
                <div style="text-align: center; font-size: 24px; font-weight: bold; color: var(--imperial-red); margin-bottom: 30px;">
                    ${q.question}
                </div>
            `;
            
            document.getElementById('quizOptions').innerHTML = q.options.map((opt, idx) => `
                <div class="quiz-option" onclick="checkAnswer(${idx})">${opt}</div>
            `).join('');
        }

        function checkAnswer(selectedIdx) {
            const q = quizQuestions[currentQuizIndex];
            const options = document.querySelectorAll('.quiz-option');
            
            if (selectedIdx === q.correct) {
                options[selectedIdx].classList.add('correct');
                quizScore += 20;
                addXP(50);
                showAchievement('âœ… Benar! +50 XP');
            } else {
                options[selectedIdx].classList.add('incorrect');
                options[q.correct].classList.add('correct');
                showAchievement('âŒ Salah! Coba lagi!');
            }
            
            document.getElementById('quizScore').textContent = quizScore;
            
            setTimeout(() => {
                currentQuizIndex++;
                displayQuizQuestion();
            }, 1500);
        }

        function endQuiz() {
            document.getElementById('quizQuestion').innerHTML = `
                <div style="text-align: center; font-size: 28px; font-weight: bold; color: var(--emperor-gold); margin-bottom: 20px;">
                    ğŸ‰ QUIZ SELESAI! ğŸ‰
                </div>
            `;
            document.getElementById('quizOptions').innerHTML = `
                <div style="text-align: center; font-size: 22px; margin: 20px 0;">
                    Skor Akhir: <strong style="color: var(--imperial-red);">${quizScore}/100</strong>
                </div>
            `;
        }

        // ==================== ADVANCED FEATURES ====================
        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'zh-CN';
                speechSynthesis.speak(utterance);
            } else {
                alert('ğŸ”Š Browser tidak mendukung text-to-speech');
            }
        }

        function addToFavorite(id) {
            showAchievement(`â­ Ditambahkan ke favorit! ID: ${id}`);
        }

        function analyzeCharacter(char) {
            if (!char) return;
            
            const radicals = {
                'ç‹': ['ä¸€', 'ä¸€', 'åœŸ'],
                'ä¸º': ['ä¸¶', 'åŠ›'],
                'æ³½': ['æ°µ', 'å°º', 'åœŸ'],
                'æ±ª': ['æ°µ', 'ç‹']
            };
            
            const etymology = {
                'ç‹': 'Simbol tiga garis horizontal yang mewakili langit, manusia, dan bumi, dengan garis vertikal yang menyatukan semuanya (raja).',
                'ä¸º': 'Tangan (æ‰‹) dengan tambahan elemen yang menunjukkan tindakan atau melakukan sesuatu.',
                'æ³½': 'Kombinasi radikal air (æ°µ) dan elemen yang berarti "pilihan" atau "berkah", menggambarkan danau atau rawa yang memberikan kehidupan.',
                'æ±ª': 'Kombinasi radikal air (æ°´) dan raja (ç‹), menggambarkan air yang melimpah seperti kerajaan.'
            };
            
            document.getElementById('radicals').innerHTML = radicals[char] 
                ? radicals[char].map(r => `<div class="radical-part">${r}</div>`).join('')
                : 'Radikal tidak ditemukan dalam database';
                
            document.getElementById('etymology').textContent = etymology[char] || 'Etimologi tidak tersedia';
            document.getElementById('strokeOrder').textContent = 'Lihat animasi goresan untuk detail urutan';
        }

        function playTone(tone) {
            const toneTexts = ['mÄ', 'mÃ¡', 'mÇ', 'mÃ '];
            speak(toneTexts[tone - 1]);
        }

        function startToneQuiz() {
            alert('ğŸµ Tone Quiz akan segera hadir! Fitur ini dalam pengembangan.');
        }

        function loadContextSentences() {
            const topic = document.getElementById('contextTopic').value;
            const sentences = {
                'Perkenalan': [
                    {zh: 'ä½ å¥½ï¼Œæˆ‘å«ç‹ä¸ºæ³½ã€‚', py: 'NÇ hÇo, wÇ’ jiÃ o WÃ¡ng WÃ©izÃ©.', id: 'Halo, nama saya Wang Weize.'},
                    {zh: 'å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚', py: 'HÄ›n gÄoxÃ¬ng rÃ¨nshi nÇ.', id: 'Senang berkenalan denganmu.'}
                ],
                'Bisnis': [
                    {zh: 'è¿™ä¸ªä»·æ ¼æ€ä¹ˆæ ·ï¼Ÿ', py: 'ZhÃ¨ge jiÃ gÃ© zÄ›nmeyÃ ng?', id: 'Bagaimana dengan harga ini?'},
                    {zh: 'æˆ‘ä»¬å¯ä»¥åˆä½œã€‚', py: 'WÇ’men kÄ›yÇ hÃ©zuÃ².', id: 'Kita bisa bekerjasama.'}
                ],
                'Makanan': [
                    {zh: 'ä½ æƒ³åƒä»€ä¹ˆï¼Ÿ', py: 'NÇ xiÇng chÄ« shÃ©nme?', id: 'Mau makan apa?'},
                    {zh: 'è¿™ä¸ªèœå¾ˆå¥½åƒã€‚', py: 'ZhÃ¨ge cÃ i hÄ›n hÇochÄ«.', id: 'Makanan ini enak sekali.'}
                ]
            };
            
            const selected = sentences[topic] || sentences['Perkenalan'];
            document.getElementById('contextSentences').innerHTML = selected.map(s => `
                <div class="context-sentence">
                    <div class="font-bold text-xl mb-2" style="color: var(--imperial-red);">${s.zh}</div>
                    <div style="color: #9333EA; margin-bottom: 5px;">${s.py}</div>
                    <div style="color: #666;">${s.id}</div>
                </div>
            `).join('');
        }

        function renderStreakCalendar() {
            const calendar = document.getElementById('streakCalendar');
            const days = 30;
            let html = '';
            
            for (let i = 0; i < days; i++) {
                const isComplete = Math.random() > 0.3;
                html += `<div class="streak-day ${isComplete ? 'streak-complete' : 'streak-incomplete'}" title="Hari ${i + 1}"></div>`;
            }
            
            calendar.innerHTML = html;
        }

        // ==================== ACHIEVEMENT SYSTEM ====================
        function showAchievement(message) {
            const popup = document.createElement('div');
            popup.className = 'achievement-popup';
            popup.textContent = message;
            document.body.appendChild(popup);
            
            setTimeout(() => {
                popup.style.animation = 'slideIn 0.5s ease-out reverse';
                setTimeout(() => popup.remove(), 500);
            }, 3000);
        }

        // ==================== LOCAL STORAGE ====================
        function saveUserData() {
            localStorage.setItem('userStats', JSON.stringify(userStats));
        }

        function loadUserData() {
            const saved = localStorage.getItem('userStats');
            if (saved) {
                userStats = JSON.parse(saved);
                updateUI();
            }
        }

        // ==================== ANGPAO SYSTEM ====================
        function loadAngpaoData() {
            const saved = localStorage.getItem('saldoAngpao');
            if (saved) {
                saldoAngpao = parseInt(saved);
            }
            updateAngpaoUI();
        }

        function updateAngpaoUI() {
            document.getElementById('saldoDisplay').textContent = 'Rp ' + saldoAngpao.toLocaleString('id-ID');
            localStorage.setItem('saldoAngpao', saldoAngpao);
        }

        function bukaAngpao() {
            const overlay = document.getElementById('welcomeOverlay');
            const bgm = document.getElementById('bgm');
            
            // Play BGM
            bgm.play().catch(err => console.log('Audio autoplay blocked:', err));
            
            // Hide overlay dengan fade
            overlay.classList.add('hidden');
            
            // ğŸ”¥ FIX BUG: HAPUS penambahan saldo di sini!
            // Saldo hanya bertambah melalui addXP()
            setTimeout(() => {
                showAchievement('ğŸ§§ Selamat Tahun Baru Imlek! Mulai belajar untuk dapat angpao!');
            }, 800);
        }

        function tarikCuan() {
            if (saldoAngpao < 1000000) {
                alert('âŒ Kerja keras lagi bos! Saldo belum 1 Juta!\n\nSaldo saat ini: Rp ' + saldoAngpao.toLocaleString('id-ID'));
                return;
            }
            
            document.getElementById('withdrawAmount').value = 'Rp ' + saldoAngpao.toLocaleString('id-ID');
            document.getElementById('withdrawModal').classList.add('active');
        }

        function tutupModal() {
            document.getElementById('withdrawModal').classList.remove('active');
            document.getElementById('withdrawForm').reset();
        }

        document.getElementById('withdrawForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const walletType = document.getElementById('walletType').value;
            const fullName = document.getElementById('fullName').value;
            const accountNumber = document.getElementById('accountNumber').value;
            const amount = saldoAngpao;
            
            const message = `ğŸ§§ *PENARIKAN SALDO ANGPAO IMLEK* ğŸ®

ğŸ“ *Data Penarikan:*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’³ E-Wallet: ${walletType}
ğŸ‘¤ Nama: ${fullName}
ğŸ“± Nomor: ${accountNumber}
ğŸ’° Jumlah: Rp ${amount.toLocaleString('id-ID')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Mohon diproses ya Boss Wang Weize! 
æ­å–œå‘è´¢! ğŸ®ğŸ§§`;
            
            const waLink = `https://wa.me/6288277200044?text=${encodeURIComponent(message)}`;
            window.open(waLink, '_blank');
            
            tutupModal();
            showAchievement('âœ… Permintaan penarikan dikirim ke WhatsApp!');
        });

        // ==================== INITIALIZATION ====================
        window.addEventListener('load', function() {
            console.log('ğŸ® Initializing Wang Weize Mega App...');
            
            // Generate 20k data
            generateMegaData();
            
            // Init canvas
            initDraw();
            
            // Load user data
            loadUserData();
            loadAngpaoData();
            
            // Particles
            const pc = document.getElementById('particle-container');
            const sym = ['ğŸ®', 'ğŸ§§', 'ğŸª™', 'ğŸ‰', 'ğŸ§¨'];
            for(let i=0; i<25; i++) {
                const p = document.createElement('div'); 
                p.className = 'imperial-particle';
                p.style.left = Math.random()*100+'%'; 
                p.style.animationDuration = (5 + Math.random()*10)+'s';
                p.style.animationDelay = Math.random()*5+'s';
                p.textContent = sym[Math.floor(Math.random()*sym.length)];
                pc.appendChild(p);
            }
            
            // Study streak
            const lastStudy = localStorage.getItem('lastStudyDate');
            const today = new Date().toDateString();
            if (lastStudy !== today) {
                if (lastStudy && new Date(lastStudy).getTime() === new Date(today).getTime() - 86400000) {
                    userStats.studyStreak++;
                } else if (!lastStudy) {
                    userStats.studyStreak = 1;
                } else {
                    userStats.studyStreak = 1;
                }
                localStorage.setItem('lastStudyDate', today);
                saveUserData();
            }
            
            console.log('âœ… App initialized successfully!');
            console.log('ğŸ“Š Total sentences:', vocabData.length);
            console.log('ğŸ’° Saldo Angpao:', saldoAngpao);
        });
    </script>
</body>
</html>
